<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" 
        crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <title> Ricerca </title>
    <h1 style="text-align:center">Centri culturali di Bologna</h1>
    <p style="text-align:center"> Ricerca la struttura di tuo interesse! </p>
    
    <style>
        #homePage{
          background-color: blue;
          color: whitesmoke;
          margin-top:40px;
          margin-bottom: 10px;
        }
        
  </style>

</head>
<body>
        <div class="container p-3 text-center" style="background-color: rgb(155, 196, 233);">
                <div class="row" id="colonnaNome">
                    <div class="col">
                        <p> Inserisci il nome della struttura da ricercare </p>
                    </div>
                    <div class="col">
                            <input 
                                type="text" 
                                placeholder="Search.." 
                                name="nome" 
                                id="nome">               
                            <button class="btn" id="searchBtn" >
                            cerca</button>
                    </div>
                </div>
        </div>
        <div class="container text-center">
            <a href="/" class="btn" id="homePage" style="margin-top:20px;">Torna alla Home Page</a>
        </div>

        <div class="container text-center" id = "risultato"></div> 
    
        <script> 
        
            const element = document.getElementById("searchBtn");
            element.addEventListener("click", researchStructure);
            
            async function researchStructure() {

                let table = '<table id="table" style="margin-top: 20px">'+
                        '<thead style="background-color: rgb(86, 86, 244)">' +
                        '<tr><th scope="col"> Denominazione: </th>' +
                        '<th scope="col"> Quartiere </th>' +
                        '<th scope="col"> Indirizzo </th>' +
                        '<th scope="col"> Categoria </th>' +
                        '<th scope="col"> Descrizione </th></tr>' +
                        '</thead><tbody id="tabellaDati">';

                const nome = document.getElementById("nome").value;

                if(nome != ""){
                    const response =  await fetch('/cercaNome?' + new URLSearchParams({Denominazione: nome}));
                    console.log(response);
         
                    if(response.ok) {
                        const struttura = await response.json();

                        table +=
                                '<tr class="fw-lighter"><th scope="row">' + 
                                        JSON.stringify(struttura.Denominazione) + '</th>' +
                                '<td>' + JSON.stringify(struttura.Quartiere) + '</td>' + 
                                '<td>' + JSON.stringify(struttura.Indirizzo) + '</td>' +
                                '<td>' + JSON.stringify(struttura.Categoria) + '</td>' +
                                '<td>' + JSON.stringify(struttura.Descrizione) + '</td>';
                    
                    table += "</td></tbody></table>";
                        document.getElementById('risultato').innerHTML = "Elemento trovato: <br>" + table; 
                    } else {
                        console.log("non esiste questa struttura")
                        document.getElementById("risultato").innerHTML =  "Struttura insesistente INESISTENTE";
                    } 
                }else{
                    alert("ATTENZIONE! Campo vuoto.")
                }             
            }              
        </script>
</body>
</html>